/*!
 * WFPlayer.js v1.1.4
 * Github: https://github.com/zhw2590582/WFPlayer#readme
 * (c) 2017-2021 Harvey Zack
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).WFPlayer=e()}(this,function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e){return t(e={exports:{}},e.exports),e.exports}var n=e(r(function(t){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},t.exports.default=t.exports,t.exports.__esModule=!0})),o=e(r(function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0})),i=e(r(function(t){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t},t.exports.default=t.exports,t.exports.__esModule=!0})),a=r(function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.default=t.exports,t.exports.__esModule=!0}),s=e(a),u=r(function(r){function n(t,e){return r.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r.exports.default=r.exports,r.exports.__esModule=!0,n(t,e)}r.exports=n,r.exports.default=r.exports,r.exports.__esModule=!0});e(u);var c=e(r(function(t){t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)},t.exports.default=t.exports,t.exports.__esModule=!0})),l=r(function(e){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(t){return typeof t}:e.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e.exports.default=e.exports,e.exports.__esModule=!0,r(t)}e.exports=r,e.exports.default=e.exports,e.exports.__esModule=!0});e(l);var f=e(r(function(t){var r=l.default;t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?a(t):e},t.exports.default=t.exports,t.exports.__esModule=!0})),d=r(function(e){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},e.exports.default=e.exports,e.exports.__esModule=!0,r(t)}e.exports=r,e.exports.default=e.exports,e.exports.__esModule=!0}),h=e(d),p=r(function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return t.constructor?t.constructor.name:null}function u(t,e){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:["option"];return c(t,e,r),l(t,e,r),function(i,a,s){var t=f(a),e=f(i);if("object"===t){if("object"!==e)throw new Error("[Type Error]: '".concat(s.join("."),"' require 'object' type, but got '").concat(e,"'"));Object.keys(a).forEach(function(t){var e=i[t],r=a[t],n=s.slice();n.push(t),c(e,r,n),l(e,r,n),u(e,r,n)})}if("array"===t){if("array"!==e)throw new Error("[Type Error]: '".concat(s.join("."),"' require 'array' type, but got '").concat(e,"'"));i.forEach(function(t,e){var r=i[e],n=a[e]||a[0],o=s.slice();o.push(e),c(r,n,o),l(r,n,o),u(r,n,o)})}}(t,e,r),t}function c(t,e,r){if("string"===f(e)){var n=f(t);if(!(-1<(e="?"===e[0]?e.slice(1)+"|undefined":e).indexOf("|")?e.split("|").map(function(t){return t.toLowerCase().trim()}).filter(Boolean).some(function(t){return n===t}):e.toLowerCase().trim()===n))throw new Error("[Type Error]: '".concat(r.join("."),"' require '").concat(e,"' type, but got '").concat(n,"'"))}}function l(t,e,r){if("function"===f(e)){e=e(t,f(t),r);if(!0!==e){t=f(e);throw"string"===t?new Error(e):"error"===t?e:new Error("[Validator Error]: The scheme for '".concat(r.join("."),"' validator require return true, but got '").concat(e,"'"))}}}var i,f;t.exports=(i=Object.prototype.toString,u.kindOf=f=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var e,r=n(t);if("boolean"===r)return"boolean";if("string"===r)return"string";if("number"===r)return"number";if("symbol"===r)return"symbol";if("function"===r)return"GeneratorFunction"===o(t)?"generatorfunction":"function";if(e=t,Array.isArray?Array.isArray(e):e instanceof Array)return"array";if(t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t))return"buffer";if(function(t){try{if("number"==typeof t.length&&"function"==typeof t.callee)return 1}catch(t){if(-1!==t.message.indexOf("callee"))return 1}}(t))return"arguments";if(t instanceof Date||"function"==typeof t.toDateString&&"function"==typeof t.getDate&&"function"==typeof t.setDate)return"date";if(t instanceof Error||"string"==typeof t.message&&t.constructor&&"number"==typeof t.constructor.stackTraceLimit)return"error";if(t instanceof RegExp||"string"==typeof t.flags&&"boolean"==typeof t.ignoreCase&&"boolean"==typeof t.multiline&&"boolean"==typeof t.global)return"regexp";switch(o(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if("function"==typeof t.throw&&"function"==typeof t.return&&"function"==typeof t.next)return"generator";switch(r=i.call(t)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return r.slice(8,-1).toLowerCase().replace(/\s/g,"")},u)}),y=function(){function t(){o(this,t)}return i(t,[{key:"on",value:function(t,e,r){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:r}),this}},{key:"once",value:function(n,o,i){var a=this;function s(){a.off(n,s);for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];o.apply(i,e)}return s._=o,this.on(n,s,i)}},{key:"emit",value:function(t){for(var e=((this.e||(this.e={}))[t]||[]).slice(),r=arguments.length,n=new Array(1<r?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];for(var i=0;i<e.length;i+=1)e[i].fn.apply(e[i].ctx,n);return this}},{key:"off",value:function(t,e){var r=this.e||(this.e={}),n=r[t],o=[];if(n&&e)for(var i=0,a=n.length;i<a;i+=1)n[i].fn!==e&&n[i].fn._!==e&&o.push(n[i]);return o.length?r[t]=o:delete r[t],this}}]),t}(),m=function(){function t(){o(this,t),this.destroyEvents=[],this.proxy=this.proxy.bind(this)}return i(t,[{key:"proxy",value:function(e,t,r){var n=this,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};Array.isArray(t)?t.forEach(function(t){return n.proxy(e,t,r,o)}):(e.addEventListener(t,r,o),this.destroyEvents.push(function(){e.removeEventListener(t,r,o)}))}},{key:"destroy",value:function(){this.destroyEvents.forEach(function(t){return t()})}}]),t}(),g=r(function(t){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")},t.exports.default=t.exports,t.exports.__esModule=!0});e(g);var v=r(function(t){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}},t.exports.default=t.exports,t.exports.__esModule=!0});e(v);var b=r(function(n){function o(t,e,r){return v()?n.exports=o=Reflect.construct:n.exports=o=function(t,e,r){var n=[null];n.push.apply(n,e);n=new(Function.bind.apply(t,n));return r&&u(n,r.prototype),n},n.exports.default=n.exports,n.exports.__esModule=!0,o.apply(null,arguments)}n.exports=o,n.exports.default=n.exports,n.exports.__esModule=!0});e(b);var w=e(r(function(e){function n(t){var r="function"==typeof Map?new Map:void 0;return e.exports=n=function(t){if(null===t||!g(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,e)}function e(){return b(t,arguments,d(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),u(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0,n(t)}e.exports=n,e.exports.default=e.exports,e.exports.__esModule=!0})),x=r(function(t,e){String.prototype.padEnd||(String.prototype.padEnd=function(t,e){return t>>=0,e=String(void 0!==e?e:""),this.length>t?String(this):((t-=this.length)>e.length&&(e+=e.repeat(t/e.length)),String(this)+e.slice(0,t))}),t.exports={d2t:function(t){if(n=t,n=String(n),/^(\d+)(\.\d{1,3})?$/.test(n)){var e=new Date(null),r=String(t).split("."),n=r[0],r=r[1]?r[1].padEnd(3,0):0;return e.setSeconds(Number(n)),e.setMilliseconds(Number(r)),e.toISOString().substr(11,12)}throw new Error("The format of the duration is incorrect: "+t);var n},t2d:function(t){if(/^(\d+):([0-5][0-9]):([0-5][0-9])(\.\d{3})?$/.test(t)){var e=t.split(".")[0].split(":"),r=Number(t.split(".")[1]||0)/1e3;return 3600*Number(e[0])+60*Number(e[1])+Number(e[2])+r}throw new Error("The format of the time is incorrect: "+t)}}});function S(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=h(r);return e=n?(t=h(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),f(this,e)}}var k=function(t){c(r,t);var e=S(r);function r(t){return o(this,r),(t=e.call(this,t)).name="WFPlayerError",t}return r}(w(Error));function T(t,e){if(!t)throw new k(e);return t}function E(t,e,r){return Math.max(Math.min(t,Math.max(e,r)),Math.min(e,r))}var O=function(){function e(t){o(this,e),this.wf=t,this.canvas=null,this.update()}return i(e,[{key:"update",value:function(){var t=this.wf.options,e=t.container,r=t.pixelRatio,n=e.clientWidth,t=e.clientHeight;this.canvas?(this.canvas.width=n*r,this.canvas.height=t*r):(T(this.wf.constructor.instances.every(function(t){return t.options.container!==e}),"Cannot mount multiple instances on the same dom element, please destroy the previous instance first."),T(n&&t,"The width and height of the container cannot be 0"),e.innerHTML="",this.canvas=document.createElement("canvas"),this.canvas.width=n*r,this.canvas.height=t*r,this.canvas.style.width="100%",this.canvas.style.height="100%",e.appendChild(this.canvas))}},{key:"exportImage",value:function(){var t=document.createElement("a");t.style.display="none",t.href=this.canvas.toDataURL("image/png"),t.download="".concat(Date.now(),".png"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}},{key:"destroy",value:function(){this.wf.options.container.innerHTML=""}}]),e}(),C=function(){function r(t){var e=this;o(this,r),this.wf=t,this.canvas=t.template.canvas,this.ctx=this.canvas.getContext("2d"),this.gridNum=0,this.gridGap=0,this.beginTime=0,this.update(),t.on("options",function(){e.update()}),t.on("channelData",function(){e.update()})}return i(r,[{key:"update",value:function(){var t=this.wf,e=t.currentTime,r=t.options,n=r.cursor,o=r.grid,i=r.ruler,a=r.wave,t=r.duration,r=r.padding;this.gridNum=10*t+2*r,this.gridGap=this.canvas.width/this.gridNum,this.beginTime=Math.floor(e/t)*t,this.density={1:5,2:4,3:3,4:3,5:2,6:2,7:2,8:2}[Math.floor(this.gridGap)]||1,this.wf.emit("render",{padding:r,duration:t,gridGap:this.gridGap,gridNum:this.gridNum,beginTime:this.beginTime}),this.drawBackground(),o&&this.drawGrid(),i&&this.drawRuler(),a&&this.drawWave(),n&&this.drawCursor()}},{key:"drawBackground",value:function(){var t=this.wf.options,e=t.backgroundColor,r=t.paddingColor,n=t.padding,o=this.canvas,t=o.width,o=o.height;this.ctx.clearRect(0,0,t,o),this.ctx.fillStyle=e,this.ctx.fillRect(0,0,t,o),this.ctx.fillStyle=r,this.ctx.fillRect(0,0,n*this.gridGap,o),this.ctx.fillRect(t-n*this.gridGap,0,n*this.gridGap,o)}},{key:"drawWave",value:function(){for(var t=this.wf,e=t.currentTime,r=t.options,n=r.progress,o=r.waveColor,i=r.progressColor,a=r.duration,s=r.padding,u=r.waveScale,c=t.decoder,l=c.channelData,r=c.audiobuffer.sampleRate,t=this.canvas,c=t.width,f=t.height/2,d=c-this.gridGap*s*2,c=E(this.beginTime*r,0,1/0),h=E((this.beginTime+a)*r,c,1/0),p=Math.floor((h-c)/d),y=s*this.gridGap+(e-this.beginTime)*this.gridGap*10,m=0,g=0,v=1,b=-1,w=c;w<h;w+=1){m+=1;var x=l[w]||0;x<v?v=x:b<x&&(b=x),p<=m&&g<d&&(g+=1,x=this.gridGap*s+g,this.ctx.fillStyle=n&&x<=y?i:o,this.ctx.fillRect(x,(1+v*u)*f,1,Math.max(1,(b-v)*f*u)),m=0,b=-(v=1))}}},{key:"drawGrid",value:function(){var t=this.wf.options,e=t.gridColor,r=t.pixelRatio,t=this.canvas,n=t.width,o=t.height;this.ctx.fillStyle=e;for(var i=0;i<this.gridNum;i+=this.density)this.ctx.fillRect(this.gridGap*i,0,r,o);for(var a=0;a<o/this.gridGap;a+=this.density)this.ctx.fillRect(0,this.gridGap*a,n,r)}},{key:"drawRuler",value:function(){var t=this.wf.options,e=t.rulerColor,r=t.pixelRatio,n=t.padding,o=t.rulerAtTop,i=this.canvas.height;this.ctx.font="".concat(11*r,"px Arial"),this.ctx.fillStyle=e;for(var a=-1,s=0;s<this.gridNum;s+=1)s&&n<=s&&s<=this.gridNum-n&&(s-n)%10==0?(a+=1,this.ctx.fillRect(this.gridGap*s,o?0:i-15*r,r,15*r),(s-n)%(10*this.density)==0&&this.ctx.fillText(function(t){return x.d2t((0<arguments.length&&void 0!==t?t:0).toFixed(3))}(this.beginTime+a).split(".")[0],this.gridGap*s-11*r*2+r,o?30*r:i-30*r+11)):s&&(s-n)%5==0&&this.ctx.fillRect(this.gridGap*s,o?0:i-7.5*r,r,7.5*r)}},{key:"drawCursor",value:function(){var t=this.wf,e=t.currentTime,r=t.options,n=r.cursorColor,o=r.pixelRatio,t=r.padding,r=this.canvas.height;this.ctx.fillStyle=n;e=t*this.gridGap+(e-this.beginTime)*this.gridGap*10;this.ctx.fillRect(e,0,o,r)}}]),r}();var j=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},w="object"==typeof t&&t&&t.Object===Object&&t,t="object"==typeof self&&self&&self.Object===Object&&self,_=w||t||Function("return this")(),R=function(){return _.Date.now()},A=/\s/;var M=function(t){for(var e=t.length;e--&&A.test(t.charAt(e)););return e},D=/^\s+/;var G=function(t){return t&&t.slice(0,M(t)+1).replace(D,"")},w=_.Symbol,t=Object.prototype,P=t.hasOwnProperty,N=t.toString,z=w?w.toStringTag:void 0;var I=function(t){var e=P.call(t,z),r=t[z];try{var n=!(t[z]=void 0)}catch(t){}var o=N.call(t);return n&&(e?t[z]=r:delete t[z]),o},L=Object.prototype.toString;var F=function(t){return L.call(t)},B=w?w.toStringTag:void 0;var W=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(B&&B in Object(t)?I:F)(t)};var U=function(t){return null!=t&&"object"==typeof t};var q=function(t){return"symbol"==typeof t||U(t)&&"[object Symbol]"==W(t)},H=/^[-+]0x[0-9a-f]+$/i,$=/^0b[01]+$/i,V=/^0o[0-7]+$/i,X=parseInt;var J=function(t){if("number"==typeof t)return t;if(q(t))return NaN;if(j(t)&&(e="function"==typeof t.valueOf?t.valueOf():t,t=j(e)?e+"":e),"string"!=typeof t)return 0===t?t:+t;t=G(t);var e=$.test(t);return e||V.test(t)?X(t.slice(2),e?2:8):H.test(t)?NaN:+t},K=Math.max,Q=Math.min;var Y=function(n,r,t){var o,i,a,s,u,c,l=0,f=!1,d=!1,e=!0;if("function"!=typeof n)throw new TypeError("Expected a function");function h(t){var e=o,r=i;return o=i=void 0,l=t,s=n.apply(r,e)}function p(t){var e=t-c;return void 0===c||r<=e||e<0||d&&a<=t-l}function y(){var t,e=R();if(p(e))return m(e);u=setTimeout(y,(e=r-((t=e)-c),d?Q(e,a-(t-l)):e))}function m(t){return u=void 0,e&&o?h(t):(o=i=void 0,s)}function g(){var t=R(),e=p(t);if(o=arguments,i=this,c=t,e){if(void 0===u)return l=e=c,u=setTimeout(y,r),f?h(e):s;if(d)return clearTimeout(u),u=setTimeout(y,r),h(c)}return void 0===u&&(u=setTimeout(y,r)),s}return r=J(r)||0,j(t)&&(f=!!t.leading,d="maxWait"in t,a=d?K(J(t.maxWait)||0,r):a,e="trailing"in t?!!t.trailing:e),g.cancel=function(){void 0!==u&&clearTimeout(u),o=c=i=u=void(l=0)},g.flush=function(){return void 0===u?s:m(R())},g};var Z=function(t,e,r){var n=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return j(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),Y(t,e,{leading:n,maxWait:e,trailing:o})},tt=function(){function r(t){var e=this;o(this,r),this.wf=t,this.audioCtx=new(window.AudioContext||window.webkitAudioContext),this.throttleDecodeAudioData=Z(this.decodeAudioData,1e3),this.audiobuffer=this.audioCtx.createBuffer(2,22050,44100),this.channelData=new Float32Array,this.wf.on("loading",function(t){e.throttleDecodeAudioData(t)})}return i(r,[{key:"decodeAudioData",value:function(t){var e=this;this.audioCtx.decodeAudioData(t.buffer,function(t){return e.decodeSuccess(t)},function(){return null})}},{key:"decodeSuccess",value:function(t){this.audiobuffer=t,this.wf.emit("audiobuffer",this.audiobuffer),this.wf.emit("decodeing",this.audiobuffer.duration/this.wf.duration),this.channelData=t.getChannelData(this.wf.options.channel),this.wf.emit("channelData",this.channelData)}},{key:"changeChannel",value:function(t){this.channelData=this.audiobuffer.getChannelData(t),this.wf.emit("channelData",this.channelData)}},{key:"destroy",value:function(){this.audiobuffer=this.audioCtx.createBuffer(2,22050,44100),this.channelData=new Float32Array}}]),r}(),et=function(){function e(t){o(this,e),this.wf=t,this.fileSize=0,this.loadSize=0,this.data=new Uint8Array,this.reader=null,this.abortController=null}return i(e,[{key:"load",value:function(t){var e=this;this.destroy(),this.abortController=new AbortController;var r=this.wf.options,n=r.withCredentials,o=r.cors,r=r.headers;return this.wf.emit("loadStart"),fetch(t,{credentials:n?"include":"omit",mode:o?"cors":"no-cors",signal:this.abortController.signal,headers:r}).then(function(t){return t.body&&"function"==typeof t.body.getReader?(e.fileSize=Number(t.headers.get("content-length")),e.wf.emit("fileSize",e.fileSize),e.reader=t.body.getReader(),function r(){var n=this;return this.reader.read().then(function(t){var e=t.done,t=t.value;return e?(n.wf.emit("loadEnd"),null):(n.loadSize+=t.byteLength,n.wf.emit("downloading",n.loadSize/n.fileSize),n.data=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e[0].constructor;return e.reduce(function(t,e){var r=new n((0|t.byteLength)+(0|e.byteLength));return r.set(t,0),r.set(e,0|t.byteLength),r},new n)}(n.data,t),n.wf.emit("loading",n.data.slice()),r.call(n))})}.call(e)):t.arrayBuffer()}).then(function(t){t&&t.byteLength&&(t=new Uint8Array(t),e.fileSize=t.byteLength,e.wf.emit("fileSize",e.fileSize),e.loadSize=t.byteLength,e.wf.emit("downloading",e.loadSize/e.fileSize),e.wf.emit("loading",t),e.wf.emit("loadEnd"))})}},{key:"destroy",value:function(){this.fileSize=0,this.loadSize=0,this.data=new Uint8Array,this.reader&&(this.reader.cancel(),this.reader=null),this.abortController&&(this.abortController.abort(),this.abortController=null)}}]),e}(),rt=function(){function r(t){var e=this;o(this,r),this.wf=t,this.playTimer=null,this.wf.on("load",function(){e.clickInit(),e.resizeInit(),e.playInit()})}return i(r,[{key:"getTimeFromEvent",value:function(t){var e=this.wf,r=e.currentTime,n=e.template.canvas,o=e.options,i=o.duration,a=o.padding,e=o.container,o=o.pixelRatio,n=n.width/(10*i+2*a),a=E(t.pageX-e.offsetLeft-a*n/o,0,1/0);return Math.floor(r/i)*i+E(a/n*o/10,0,i)}},{key:"clickInit",value:function(){var r=this,t=this.wf,e=t.template.canvas,n=t.events.proxy,o=t.options.mediaElement;n(e,["click","contextmenu"],function(t){var e=r.getTimeFromEvent(t);r.wf.emit(t.type,e,t),o&&o.currentTime!==e&&(o.currentTime=e),r.wf.drawer.update()})}},{key:"resizeInit",value:function(){var t=this,e=this.wf,r=e.template,n=e.drawer,e=e.events.proxy,o=Z(function(){r.update(),n.update(),t.wf.emit("resize")},500);e(window,["resize","orientationchange"],function(){o()})}},{key:"playInit",value:function(){var t=this.wf,r=t.drawer,e=t.events.proxy,n=t.options.mediaElement;n&&(e(n,"seeked",function(){r.update()}),function t(){var e=this;this.playTimer=requestAnimationFrame(function(){e.wf.playing&&(r.update(),e.wf.emit("playing",n.currentTime)),e.wf.isDestroy||t.call(e)})}.call(this))}},{key:"destroy",value:function(){cancelAnimationFrame(this.playTimer)}}]),r}();function nt(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)),n}function ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(r),!0).forEach(function(t){n(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function it(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=h(r);return e=n?(t=h(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),f(this,e)}}var at=0,st=[];return function(){c(n,y);var r=it(n);function n(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return o(this,n),(t=r.call(this))._currentTime=0,t.isDestroy=!1,t.options={},t.setOptions(e),t.events=new m(s(t)),t.template=new O(s(t)),t.decoder=new tt(s(t)),t.drawer=new C(s(t)),t.controller=new rt(s(t)),t.loader=new et(s(t)),at+=1,t.id=at,st.push(s(t)),t}return i(n,[{key:"currentTime",get:function(){return this.options.mediaElement?this.options.mediaElement.currentTime:this._currentTime}},{key:"duration",get:function(){return this.options.mediaElement?this.options.mediaElement.duration:x.t2d("99:59:59.999")}},{key:"hasChannelData",get:function(){return!!this.decoder.channelData.byteLength}},{key:"playing",get:function(){var t=this.options.mediaElement;return!!t&&!!(0<t.currentTime&&!t.paused&&!t.ended&&2<t.readyState)}},{key:"setOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return T("object"===p.kindOf(t),"setOptions expects to receive object as a parameter."),"string"==typeof t.container&&(t.container=document.querySelector(t.container)),"string"==typeof t.mediaElement&&(t.mediaElement=document.querySelector(t.mediaElement)),this.options=p(ot(ot(ot({},n.default),this.options),t),n.scheme),this.emit("options",this.options),this}},{key:"load",value:function(t){return t&&"function"==typeof t.getChannelData?this.decoder.decodeSuccess(t):(T("string"==typeof(t=t instanceof HTMLVideoElement||t instanceof HTMLAudioElement?(this.options.mediaElement=t).src:t)&&t.trim(),"The load target is not a string. If you are loading a mediaElement, make sure the mediaElement.src is not empty."),this.loader.load(t)),this.emit("load"),this}},{key:"seek",value:function(t){return T("number"==typeof t,"seek expects to receive number as a parameter."),this._currentTime=E(t,0,this.duration),this.options.mediaElement&&this.options.mediaElement.currentTime!==this._currentTime&&(this.options.mediaElement.currentTime=this._currentTime),this.drawer.update(),this}},{key:"changeChannel",value:function(t){this.setOptions({channel:t}),this.decoder.changeChannel(t)}},{key:"exportImage",value:function(){return this.template.exportImage(),this}},{key:"destroy",value:function(){this.isDestroy=!0,this.events.destroy(),this.template.destroy(),this.controller.destroy(),this.decoder.destroy(),this.loader.destroy(),st.splice(st.indexOf(this),1)}}],[{key:"instances",get:function(){return st}},{key:"version",get:function(){return"1.1.4"}},{key:"env",get:function(){return'"production"'}},{key:"default",get:function(){return{container:"#waveform",mediaElement:null,wave:!0,waveColor:"rgba(255, 255, 255, 0.1)",backgroundColor:"rgb(28, 32, 34)",paddingColor:"rgba(255, 255, 255, 0.05)",cursor:!0,cursorColor:"#ff0000",progress:!0,progressColor:"rgba(255, 255, 255, 0.5)",grid:!0,gridColor:"rgba(255, 255, 255, 0.05)",ruler:!0,rulerColor:"rgba(255, 255, 255, 0.5)",rulerAtTop:!0,withCredentials:!1,cors:!1,headers:{},channel:0,duration:10,padding:5,waveScale:.8,pixelRatio:Math.ceil(window.devicePixelRatio)}}},{key:"scheme",get:function(){function t(r,n,o,i){return function(t,e){return T("number"===e,"".concat(r," expects to receive number as a parameter, but got ").concat(e,".")),T(n<=t&&t<=o&&(!i||Number.isInteger(t)),"'options.".concat(r,"' expect ").concat(i?"an integer ":"a ","number that >= ").concat(n," and <= ").concat(o,", but got ").concat(t,".")),!0}}return{container:"htmlelement|htmldivelement",mediaElement:"null|htmlvideoelement|htmlaudioelement",wave:"boolean",waveColor:"string",backgroundColor:"string",paddingColor:"string",cursor:"boolean",cursorColor:"string",progress:"boolean",progressColor:"string",grid:"boolean",gridColor:"string",ruler:"boolean",rulerColor:"string",rulerAtTop:"boolean",withCredentials:"boolean",cors:"boolean",headers:"object",channel:t("channel",0,5,!0),duration:t("duration",1,100,!0),padding:t("padding",1,100,!0),waveScale:t("waveScale",.1,10,!1),pixelRatio:t("pixelRatio",1,10,!1)}}}]),n}()});
